<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HTML Tidy: Localize HTML Tidy</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HTML Tidy
   &#160;<span id="projectnumber">5.9.8</span>
   </div>
   <div id="projectbrief">The HTACG Tidy HTML Project</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('localize.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Localize HTML Tidy </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_pages_programming_LOCALIZE_README"></a> Thank you for your interest in helping us localize HTML Tidy and LibTidy. Users throughout the world will thank you.</p>
<p>The document describes Tidy's localization philosophy and instructs you on how you can use standard <code>gettext</code> tools to generate language and region localizations that will work with Tidy. Optionally instructions are included in the event that you want to build Tidy with your new language.</p>
<h1><a class="anchor" id="autotoc_md44"></a>
Introduction</h1>
<p>HTML Tidy is built around the localization file <code><a class="el" href="language__en_8h.html">language_en.h</a></code>; without this file HTML Tidy will not work. As such <em>all</em> language localization work originates from this single file.</p>
<p>Language localizations use header files that are identical to <code><a class="el" href="language__en_8h.html">language_en.h</a></code>, except that they have different strings. For the convenience of language translators, though, Tidy source code includes a Ruby <code>poconvert.rb</code> script that enables <em>optional</em> gettext PO/POT work streams that may be more comfortable to them.</p>
<h2><a class="anchor" id="autotoc_md45"></a>
PO and POT files</h2>
<p>HTML Tidy provides PO and POT files for language translations. The file <code>tidy.pot</code> is the correct template to use as a basis for new translations. In a typical <code>gettext</code> workflow a translator will use the <code>tidy.pot</code> file to create a language translation PO file that contains original English strings and the translated strings.</p>
<p>If a language has already been translated (or if the translation has begun) then PO files may already exist. These files are named <code>language_ll.po</code> or <code>langage_ll_CC.po</code>, where <code>ll</code> represents the language code, and optionally, <code>CC</code> represents the region code of the translation.</p>
<p>Tidy does not use MO files that <code>gettext</code> tools generate from PO files.</p>
<p>Please note that these PO and POT files are provided for translator convenience only. Tidy's <a href="#h-files">header files</a> constitute the true, controlled source code for Tidy.</p>
<h2><a class="anchor" id="autotoc_md46"></a>
H files</h2>
<p>Tidy does not use <code>gettext</code> to display strings and so <code>gettext</code>-generated MO files are not necessary. Instead translated PO files must be converted to Tidy's language header H file format. Translators are not required to perform this step, but we provide a tool to perform this function if desired.</p>
<h2><a class="anchor" id="autotoc_md47"></a>
Differences for translators</h2>
<p>Experienced users and translators of PO files may note that we use the PO file's <code>msgctxt</code> field a bit uniquely. Rather than point to a line in the source code, it contains a reference to the string's identifier. Because the PO format does not allow for arbitrary metadata this is a requirement for generating our header files.</p>
<p>If you're the type of translator the does dig into the source code, then this <code>msgtext</code> symbol is still useful to you and adds a single extra step to finding where a string is in context: a symbol or string search using the <code>msgctxt</code> value will reveal the context in source code.</p>
<p>Finally the <code>msgid</code> field is a throwaway; Tidy's language tools do not use this value and so it's only for the translator's convenience. This fact makes it convenient for translators to translate from languages other than English, which is fully supported by our tools.</p>
<h2><a class="anchor" id="autotoc_md48"></a>
&lt;tt&gt;poconvert.rb&lt;/tt&gt; versus &lt;tt&gt;gettext&lt;/tt&gt;' tools</h2>
<p>Please don't use <code>gettext</code>' tools with our PO and POT files (unless you are using our strings for a different project). Instead all workflows can be accomplished with our <code>poconvert.rb</code> tool.</p>
<p><a href="#h-files">More information about this tool</a> can be found below.</p>
<h1><a class="anchor" id="autotoc_md49"></a>
How to Contribute</h1>
<h2><a class="anchor" id="autotoc_md50"></a>
Find or Create the Translation Files</h2>
<p>If you've not already cloned the HTML Tidy source code repository that will be your first step.</p>
<p>In the <code>localize\translations\</code> directory you can find existing languages, e.g.,</p>
<ul>
<li><code>tidy.pot</code> (Tidy's POT template for translations).</li>
<li><code>language_en_gb.po</code> (British English variants for the built in language)</li>
<li>…and perhaps more.</li>
</ul>
<p>In the <code>src\</code> directory you can find the master files for existing languages, e.g.,</p>
<ul>
<li><code><a class="el" href="language__en_8h.html">language_en.h</a></code> (Tidy's native, built-in language, mostly U.S. English)</li>
<li><code>language_en_gb.po</code> (British English variants for the built in language)</li>
<li>…and perhaps more.</li>
</ul>
<p>Although the header files are the master files for HTML Tidy, we understand that not all potential translators want to edit C files directly. Therefore as an option, the following workflow to use POT and PO files is offered.</p>
<p>If the language that you want to work on is already present:</p>
<ul>
<li>Simply open the file in your favorite PO editor and then get to work.</li>
<li>Note that although you can use a text editor, we recommend that you use a dedicated PO editor so that you don't accidentally make the file illegible to our conversion utility.</li>
</ul>
<p>If the language that you want to work on is <em>not</em> already present:</p>
<ul>
<li>You can open <code>tidy.pot</code> in your favorite PO editor and use its functions to begin a new translation into your desired language.</li>
<li>Note that although you can use a text editor, we recommend that you use a dedicated PO editor so that you don't accidentally make the file illegible to our conversion utility.</li>
<li>To perform the work manually:<ul>
<li>Copy <code>tidy.pot</code> to <code>language_ll.po</code> (for a non-regional variant, or base language), or to <code>language_ll_cc.po</code> (for a region-specific variant), where <code>ll</code> indicates the two letter language code and <code>cc</code> indicates the two letter region or country code.</li>
<li>Change the pertinent PO header section accordingly.</li>
</ul>
</li>
<li>Use <code>poconvert.rb</code> to generate a PO:<ul>
<li><code>poconvert.rb msginit --locale ll</code>, where <code>ll</code> indicates the language code for the language you want to translate to. The tool recognizes the same languages as <code>gettext</code>' <code>msginit</code>. If your chosen language is not supported, then please see the manual method, above.</li>
<li>See also <code>poconvert.rb help</code> for more options.</li>
</ul>
</li>
<li>See GNU's <a href="https://www.gnu.org/software/gettext/manual/html_node/PO-Files.html">The Format of PO Files</a> for more specific instructions and important information.</li>
</ul>
<h2><a class="anchor" id="autotoc_md51"></a>
Issue a Pull Request to HTML Tidy</h2>
<p>Once your translation is complete commit your entire HTML Tidy repository to GitHub and issue a pull request (PR) against the <code>master</code> branch. If accepted a friendly developer will convert your PO into a format useful to Tidy if your PR is a PO, or will simply merge your changed header file if you changed it directly.</p>
<p>You are also welcome to perform any conversions yourself, add new languages to Tidy, and issue a PR for the whole change.</p>
<h2><a class="anchor" id="autotoc_md52"></a>
Using Git appropriately</h2>
<ol type="1">
<li>Fork the repository to your GitHub account.</li>
<li>Optionally create a <b>topical branch</b> - a branch whose name is succinct but explains what you're doing, such as "localize Portuguese".</li>
<li>Make your changes, committing at logical breaks.</li>
<li>Push your work to your personal account.</li>
<li><a href="https://help.github.com/articles/using-pull-requests">Create a pull request</a>.</li>
<li>Watch for comments or acceptance.</li>
</ol>
<h2><a class="anchor" id="autotoc_md53"></a>
Repository Notes</h2>
<p>If you are working with PO files then please <b>only</b> commit PO files with <em>English</em> <code>msgid</code> fields. The <code>gettext</code> convention specifies only English <code>msgid</code>, and other translators may not understand the original strings.</p>
<p>Our <code>poconvert.rb</code> script can generate PO files using another language as <code>msgid</code>. This can be very useful if it's easier for you to translate from another language instead of English. It can also be useful for translating from a base language to a regional variant, such as from Spanish to Mexican Spanish.</p>
<p>If you choose to work locally with a non-English PO, you can easily convert your PO to a Tidy header file and back to an English-based PO using our <code>poconvert.rb</code> script. See its documentation (<code>poconvert.rb help</code>) for instructions.</p>
<h1><a class="anchor" id="autotoc_md54"></a>
Adding Languages to Tidy</h1>
<p>Although we don't require you to follow these steps to contribute a language to Tidy, you may want to add the language to Tidy yourself to test the translation, or to save one of the developer team a few extra steps.</p>
<ul>
<li>Generate the header files if necessary:<ul>
<li>Convert your PO file to a Tidy header file by executing <code>poconvert.rb msgfmt &lt;path_to_your_file.po&gt;</code>. Note that on Windows you will likely have to preface this line with <code>ruby</code>.</li>
<li>The tool should generate a file named <code>language_ll_cc.h</code> in the working directory, where <code>ll_cc</code> will be replaced with the language/region of your translation.</li>
<li>Copy this <code>.h</code> file into <code>src\</code>.</li>
</ul>
</li>
<li>Modify Tidy's source:<ul>
<li>Edit the file <code>src\language.c</code> to ensure that the new <code>.h</code> file you added is in the header include section.</li>
<li>Look for the <code>static tidyLanguagesType tidyLanguages</code> structure starting near line 40, and look for the comment <code>These languages are installed.</code>. You can add your new language to the list along with the other languages present, following the same format.</li>
</ul>
</li>
<li>Build Tidy:<ul>
<li>Build Tidy per the usual instructions, and try it out using the <code>-lang</code> option.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md55"></a>
Best Practices</h1>
<h2><a class="anchor" id="autotoc_md56"></a>
Language Inheritance</h2>
<p>HTML Tidy will fallback from the specified language to the base language and then finally to the default English as required. This means, for example, a programmer might set <code>libtidy</code> to use “es_mx”, and if it doesn’t exist Tidy will automatically use “es”. If that doesn’t exist <code>libtidy</code> will continue to use whatever language it is currently using.</p>
<h2><a class="anchor" id="autotoc_md57"></a>
String Inheritance</h2>
<p>HTML Tidy will also fallback for individual strings. For example if <code>libtidy</code> is set to use “es_mx” and a particular string is requested and not found, the library will look for the string in “es”. If the string is not found there then the “en” string will be given.</p>
<h2><a class="anchor" id="autotoc_md58"></a>
Base Language First and Regional Variants</h2>
<p>Because of this inheritance we hope to localize base languages first, as the only strings then required for regional variants are the strings that differ. This will help us keep HTML Tidy and <code>libtidy</code> small.</p>
<p>If you are working on a regional variation (such as “us_CA”) please only localize strings that are actually <em>different</em> from the base language!</p>
<h2><a class="anchor" id="autotoc_md59"></a>
Positional Parameters</h2>
<p>Please note that HTML Tidy does not currently support positional parameters. Due to the nature of most of Tidy's output, it's not expected that they will be required. In any case, please translate strings so that substitution values are in the same order as the original string.</p>
<h1><a class="anchor" id="autotoc_md60"></a>
Testing</h1>
<p>We hope to develop a comprehensive test suite in the future, but in the meantime you can test localized output like this.</p>
<h2><a class="anchor" id="autotoc_md61"></a>
Command line option</h2>
<p>Use the <code>-lang</code>/<code>-language</code> option and specify a POSIX or Windows language name. This option should be first option used because the console application parses and acts on options first-in, first-out.</p>
<h2><a class="anchor" id="autotoc_md62"></a>
Changing your locale</h2>
<p>On Unix/Mac and Linux operating systems you can change your shell’s locale temporarily with:</p>
<p><code>export LANG=en_GB</code> <code>export LC_ALL=en_GB</code></p>
<p>…substituting, of course the language of your choice.</p>
<h2><a class="anchor" id="autotoc_md63"></a>
East Asian Languages</h2>
<p>East Asian languages are completely supported and have been tested on Linux, Mac OS X, and Windows, although Windows requires you to set your operating system (not the console locale!) to an East Asian locale to enable this in Windows Console and PowerShell. Note that PowerShell ISE always supports East Asian languages without requiring you to change your operating system locale.</p>
<h1><a class="anchor" id="autotoc_md64"></a>
gettext</h1>
<p>Although HTML Tidy uses <code>gettext</code>-compatible tools and PO files for language localization, Tidy itself does <em>not</em> use <code>gettext</code>. Tidy's build philosophy is build it anywhere and build it with anything. As <code>gettext</code> is not universally available on every platform under the sun, Tidy cannot count on <code>gettext</code>.</p>
<p>Instead Tidy builds all translations into its library (and command line executable if built monolithically), and can run on virtually any general purpose computer with any operating system.</p>
<p>While this does not pose a significant problem for storage or execution space on modern PC's, we understand that certain applications may still be space critical. As such it's trivial to build Tidy without this extra language support using the <code>-DSUPPORT_LOCALIZATIONS=NO</code> switch.</p>
<h1><a class="anchor" id="autotoc_md65"></a>
poconvert.rb</h1>
<p>Tidy's source code includes a Ruby batch file called <code>poconvert.rb</code> which can be used to generate POT, PO, and H files, and convert them back and forth. It has been designed to work in a similar fashion as <code>gettext</code>'s tools, and includes conveniences that let translators work in different source languages. Please use <code>poconvert.rb help</code> for complete information (<code>ruby poconvert.rb help</code> on Windows).</p>
<p>Note that you must install Ruby on your system, as well as install the required dependencies. These can be manually installed with <code>[sudo] gem install xxx</code>, where <code>xxx</code> represents the packages listed in <code>Gemfile</code>. For convenience, if you have the Bundler gem installed, you can <code>bundle install</code> for automated dependency installation.</p>
<p>Also take note of these two important characteristics:</p>
<ul>
<li><code>poconvert.rb</code> is currently dependent on its current path. You can move it from its current location, but you will have to change the values of the <code>@@default_en</code> and <code>@@header_template</code> variables within the script.</li>
<li>All files will be output in the current working directory. This will prevent accidental overwrites of important files while we all get used to the workflows.</li>
</ul>
<p>Below are some sample workflows.</p>
<h2><a class="anchor" id="autotoc_md66"></a>
Create a new POT file</h2>
<p>Although we provide <code>tidy.pot</code> in the source, you can generate your own.</p>
<p><code>./poconvert.rb xgettext</code></p>
<p>This will put a fresh, new copy of <code>tidy.pot</code> in the working directory.</p>
<h2><a class="anchor" id="autotoc_md67"></a>
Create a new POT file with non-English &lt;tt&gt;msgid&lt;/tt&gt; strings</h2>
<p>Although <code>gettext</code> officially recognizes English as the one, true source language for PO and POT files, if you're more comfortable translating from a non-English language, we can support you.</p>
<p><code>./poconvert.rb xgettext &lt;language_cc_ll.h&gt;</code></p>
<p>Where <code>&lt;language_cc_ll.h&gt;</code> is the path to an existing Tidy language header file. This will produce a <code>tidy.pot</code> using the translated strings as <code>msgid</code>, using English as a backup when translated strings are not present.</p>
<p>This can be valuable in producing regional variant translations, e.g., when translating from <code>es</code> to <code>es_mx</code>.</p>
<h2><a class="anchor" id="autotoc_md68"></a>
Convert an existing H to PO</h2>
<p>In many cases you may want to have a fresh PO generated from a Tidy H file. This can be accomplished with:</p>
<p><code>./poconvert.rb msgunfmt &lt;language_cc_ll.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md69"></a>
Convert an existing H to PO using a different &lt;tt&gt;msgid&lt;/tt&gt; language</h2>
<p>If you want to generate a fresh PO file from a Tidy H file, but <em>also</em> want to have untranslated strings from a language other than English, try:</p>
<p><code>./poconvert.rb msgunfmt &lt;language_cc_ll.h&gt; --baselang=&lt;other-language_cc_ll.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md70"></a>
Create a blank PO file for a particular region</h2>
<p><code>./poconvert.rb msginit</code> or <code>./poconvert.rb msginit --locale=LOCALE</code></p>
<p>The first example will try to guess your current region, and the second will use a region specified.</p>
<p>Tidy only knows about the same regions that <code>gettext</code> knows; if our <code>msginit</code> does not recognize the region you specify, you will have to create a new PO and modify the region settings yourself.</p>
<p>To create the blank PO using <code>msgid</code> strings from a different Tidy language, you can use:</p>
<p><code>./poconvert.rb msginit &lt;language_cc_ll.h&gt; [--locale=LOCALE]</code></p>
<h2><a class="anchor" id="autotoc_md71"></a>
Create a Tidy Language Header H file</h2>
<p>When you're ready to include the language in Tidy, you can generate its header file with:</p>
<p><code>./poconvert.rb msgfmt &lt;language_cc_ll.po&gt;</code></p>
<p>In the event you are creating a regional variant of a language, it's an excellent idea to have Tidy exclude strings that are already present in the parent language in order to reduce library and executable size. For example if <code>es</code> already includes the string "archivo" there is no reason for your translation to <code>es_mx</code> to include it, too. You can tell <code>poconvert.rb</code> to exclude strings matching another localization like so:</p>
<p><code>./poconvert.rb msgfmt &lt;language_cc_ll.po&gt; --baselang=&lt;other-language_cc_ll.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md72"></a>
Prepare your non-English PO for a PR</h2>
<p>Although we have provided tools to allow you to work in languages other than English, we can only accept PO's in the repository that have English <code>msgid</code> fields. It's easy to convert your PO back to English:</p>
<p><code>./poconvert msgfmt &lt;language_cc_ll.po&gt;</code></p>
<p><code>./poconvert msgunfmt &lt;language_cc_ll.h&gt;</code></p>
<p>The first command converts your non-standard PO into a Tidy Language Header file, and the second will create a fresh, new PO file from the header that you've just created.</p>
<h2><a class="anchor" id="autotoc_md73"></a>
Update your PO to match the new POT</h2>
<p>If Tidy's POT changes, e.g., new strings are added, new comments, etc., the simplest way to update your PO is to convert it to a header (which normalizes it to the latest Tidy standard), and then convert the header to a new PO again.</p>
<p><code>./poconvert msgfmt &lt;language_cc_ll.po&gt;</code></p>
<p><code>./poconvert msgunfmt &lt;language_cc_ll.h&gt;</code></p>
<h1><a class="anchor" id="autotoc_md74"></a>
Help Tidy Get Better</h1>
<p>It goes without saying <b>all help is appreciated</b>. We need to work together to make Tidy better! </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Jul 31 2021 10:21:57 for HTML Tidy by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
